<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DevOps Lifecycle — Extended Interactive</title>
<style>
  :root{
    --bg-dark: #071024;
    --card-dark: rgba(255,255,255,0.03);
    --muted: #94a3b8;
    --glass: rgba(255,255,255,0.03);
    --accent: linear-gradient(90deg,#06b6d4,#7c3aed);
    --radius: 12px;
    --maxw: 1100px;
  }
  :root.light {
    --bg-dark: #f7fbff;
    --card-dark: rgba(7,16,36,0.03);
    --muted: #42566a;
  }

  html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  body{
    background: radial-gradient(1200px 600px at 10% 10%, rgba(99,102,241,0.06), transparent),
                linear-gradient(180deg,var(--bg-dark), #071024 160%);
    color: #e6eef8;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:20px;
    box-sizing:border-box;
  }

  .wrap{
    width:100%;
    max-width:var(--maxw);
    border-radius:16px;
    padding:20px;
    box-sizing:border-box;
  }

  .topbar{
    display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:12px;
  }
  .title{
    display:flex;gap:12px;align-items:center;
  }
  h1{font-size:20px;margin:0;}
  .subtitle{font-size:13px;color:var(--muted);margin-top:2px;}

  .controls {
    display:flex;gap:8px;align-items:center;
  }
  .btn{
    background:transparent;border:1px solid rgba(255,255,255,0.06);
    padding:8px 12px;border-radius:10px;color:var(--muted);
    cursor:pointer;font-size:13px;
  }
  .btn.primary{
    background:var(--accent);border:0;color:white;
    box-shadow:0 6px 18px rgba(99,102,241,0.12);
  }

  .layout{
    display:grid;
    grid-template-columns: 1fr 360px;
    gap:18px;
  }
  @media (max-width:980px){
    .layout{grid-template-columns:1fr; }
  }

  /* left card (diagram) */
  .card {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:18px;border-radius:var(--radius);
    box-shadow: 0 10px 30px rgba(2,6,23,0.6);
  }

  .ring-wrap{
    display:flex;flex-direction:column;align-items:center;gap:12px;
  }
  svg{ width:360px;height:360px; display:block; }

  .legend {
    display:flex;gap:8px;flex-wrap:wrap;justify-content:center;
  }
  .legend .dot{display:flex;gap:8px;align-items:center;font-size:12px;color:var(--muted);}
  .color-box{width:12px;height:12px;border-radius:3px;flex:none;}

  /* right panel */
  .panel{
    display:flex;flex-direction:column;gap:12px;
  }
  .desc{
    background:rgba(255,255,255,0.02);
    padding:14px;border-radius:10px;min-height:150px;
  }
  .desc h2{margin:0 0 8px 0;}
  .desc p{margin:0;color:var(--muted);font-size:13px;line-height:1.45;}

  .tools{
    font-size:13px;color:var(--muted);
    background:rgba(255,255,255,0.01);padding:10px;border-radius:10px;
  }
  .tools ul{margin:8px 0 0 18px;padding:0;}
  .tools a{color:inherit;text-decoration:underline;opacity:0.95;}

  .small {
    display:flex;gap:8px;align-items:center;flex-wrap:wrap;
    font-size:13px;color:var(--muted);
  }

  .midcontrols{display:flex;gap:6px;align-items:center;justify-content:space-between;}
  .range { width:140px; }

  /* timeline view */
  .timeline{
    display:none;
    padding:10px;border-radius:10px;background:rgba(255,255,255,0.01);
    max-height:320px;overflow:auto;
  }
  .timeline .item{padding:8px;border-radius:8px;margin-bottom:8px;border-left:4px solid rgba(255,255,255,0.04)}
  .timeline .label{font-weight:700}

  /* footer */
  .footer{font-size:12px;color:var(--muted);text-align:center;margin-top:12px;}

  /* interactive hover */
  .segment:hover, .segment.active {
    filter: brightness(1.06) drop-shadow(0 8px 24px rgba(0,0,0,0.5));
    transform: scale(1.02);
    transition: transform 160ms ease, filter 160ms ease;
    cursor:pointer;
  }

  /* theme toggle appearance */
  .switch {
    position:relative;width:44px;height:26px;background:rgba(255,255,255,0.06);border-radius:999px;padding:3px;display:inline-block;
  }
  .knob {
    width:18px;height:18px;background:white;border-radius:999px;transform:translateX(0);transition:transform 180ms ease;
  }
  :root.light .knob{ transform:translateX(18px); }

  /* small helpers */
  .muted{color:var(--muted)}
  .nowrap{white-space:nowrap}
</style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="title">
        <div>
          <h1>DevOps Lifecycle — Interactive</h1>
          <div class="subtitle">Explore phases, recommended tools, and export diagrams for docs.</div>
        </div>
      </div>

      <div class="controls">
        <button class="btn" id="viewToggleBtn" title="Toggle wheel / timeline">Timeline View</button>
        <button class="btn" id="exportBtn" title="Export diagram as PNG">Export PNG</button>
        <div style="display:flex;align-items:center;gap:8px">
          <div class="switch" id="themeToggle" role="switch" aria-checked="false" title="Toggle theme">
            <div class="knob"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="layout">
      <div class="card" id="leftCard" aria-label="DevOps diagram card">
        <div class="ring-wrap" id="ringWrap">
          <!-- SVG -->
          <svg id="devopsSvg" viewBox="0 0 200 200" role="img" aria-label="DevOps lifecycle wheel">
            <g transform="translate(100,100)">
              <circle r="30" fill="#071127"/>
              <text id="centerText" y="4" text-anchor="middle" font-size="8" fill="#cfeffd" style="font-weight:600">DevOps</text>
            </g>
            <g id="segments" transform="translate(100,100)"></g>
          </svg>

          <div class="legend" id="legend"></div>
          <div class="small muted">Tip: Hover segments — click to lock description. Use ← → keys or numbers 1–8.</div>
        </div>
      </div>

      <div class="panel">
        <div class="desc" id="description" aria-live="polite">
          <h2 id="phaseTitle">Select a phase</h2>
          <p id="phaseText">Click a segment to view detailed info, recommended tools, and example actions for that phase.</p>
        </div>

        <div class="tools" id="toolsBox" aria-hidden="true">
          <strong>Recommended tools & actions</strong>
          <ul id="toolList"><li class="muted">Select a phase to see tools.</li></ul>
        </div>

        <div class="midcontrols">
          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn" id="prevBtn">← Prev</button>
            <button class="btn primary" id="nextBtn">Next →</button>
            <button class="btn" id="autoBtn" aria-pressed="false">Auto Rotate</button>
          </div>

          <div style="display:flex;gap:10px;align-items:center">
            <label class="muted nowrap">Speed</label>
            <input class="range" id="speedRange" type="range" min="400" max="3000" step="100" value="1600" aria-label="Auto rotate speed"/>
          </div>
        </div>

        <div id="timeline" class="timeline" aria-hidden="true"></div>

        <div class="footer">Phases: Plan → Code → Build → Test → Release → Deploy → Operate → Monitor</div>
      </div>
    </div>
  </div>

<script>
/* Data for phases including tools & example actions */
const phases = [
  { key:'plan', label:'Plan', color:'#fb7185',
    text:'Define goals, requirements, roadmap and backlog. Align stakeholders, set KPIs, and prepare sprint planning.',
    tools: ['Jira / Trello', 'Confluence', 'Product workshops'], links:['https://www.atlassian.com/software/jira', 'https://www.confluence.com/'] },
  { key:'code', label:'Code', color:'#f97316',
    text:'Developer work — write, review and manage source code. Enforce coding standards and linters.',
    tools: ['Git / GitHub / GitLab', 'Prettier / ESLint', 'Code Review'], links:['https://github.com', 'https://gitlab.com'] },
  { key:'build', label:'Build', color:'#f59e0b',
    text:'Compile code, build artifacts, and produce versioned packages using CI pipelines.',
    tools: ['CI (GitHub Actions / Jenkins)', 'Build tools (Maven, Gradle, npm)'], links:['https://github.com/features/actions','https://www.jenkins.io/'] },
  { key:'test', label:'Test', color:'#10b981',
    text:'Run automated tests — unit, integration and end-to-end. Shift-left testing and test data management.',
    tools: ['Selenium / Playwright', 'JUnit / Jest', 'Test reporting'], links:['https://playwright.dev/','https://jestjs.io/'] },
  { key:'release', label:'Release', color:'#06b6d4',
    text:'Package artifact for release, tag versions, manage change approvals and release notes.',
    tools: ['Release gating', 'Semantic versioning', 'Release notes templates'], links:[] },
  { key:'deploy', label:'Deploy', color:'#3b82f6',
    text:'Automate deployments to environments. Use IaC and strategies like blue/green or canary to reduce risk.',
    tools: ['Terraform / Ansible', 'Kubernetes', 'ArgoCD / Flux'], links:['https://www.terraform.io/','https://kubernetes.io/'] },
  { key:'operate', label:'Operate', color:'#8b5cf6',
    text:'Run the live system — scaling, incident response, backups, and maintenance tasks.',
    tools: ['PagerDuty / OpsGenie', 'Backups / Runbooks'], links:['https://www.pagerduty.com/'] },
  { key:'monitor', label:'Monitor', color:'#ec4899',
    text:'Observability: metrics, logs, traces, and alerts that provide feedback to improve the system.',
    tools: ['Prometheus / Grafana', 'ELK / Loki', 'OpenTelemetry'], links:['https://prometheus.io/','https://grafana.com/'] }
];

const svgNS = "http://www.w3.org/2000/svg";
const segGroup = document.getElementById('segments');
const legendEl = document.getElementById('legend');
const phaseTitle = document.getElementById('phaseTitle');
const phaseText = document.getElementById('phaseText');
const centerText = document.getElementById('centerText');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const autoBtn = document.getElementById('autoBtn');
const exportBtn = document.getElementById('exportBtn');
const speedRange = document.getElementById('speedRange');
const description = document.getElementById('description');
const toolList = document.getElementById('toolList');
const toolsBox = document.getElementById('toolsBox');
const themeToggle = document.getElementById('themeToggle');
const viewToggleBtn = document.getElementById('viewToggleBtn');
const timelineEl = document.getElementById('timeline');

let activeIndex = -1;
let autoTimer = null;
let autoSpeed = parseInt(speedRange.value,10);

/* Draw donut */
function describeArc(innerR, outerR, startAngle, endAngle) {
  const a0 = (Math.PI/180) * startAngle;
  const a1 = (Math.PI/180) * endAngle;
  const x1 = Math.cos(a0) * outerR;
  const y1 = Math.sin(a0) * outerR;
  const x2 = Math.cos(a1) * outerR;
  const y2 = Math.sin(a1) * outerR;
  const x3 = Math.cos(a1) * innerR;
  const y3 = Math.sin(a1) * innerR;
  const x4 = Math.cos(a0) * innerR;
  const y4 = Math.sin(a0) * innerR;
  const largeArc = (endAngle - startAngle) > 180 ? 1 : 0;
  return [
    `M ${x1} ${y1}`,
    `A ${outerR} ${outerR} 0 ${largeArc} 1 ${x2} ${y2}`,
    `L ${x3} ${y3}`,
    `A ${innerR} ${innerR} 0 ${largeArc} 0 ${x4} ${y4}`,
    'Z'
  ].join(' ');
}

const outerRadius = 80;
const innerRadius = 45;
const segAngle = 360 / phases.length;

phases.forEach((p,i) => {
  const start = i * segAngle - 90;
  const end = start + segAngle;
  const path = document.createElementNS(svgNS, 'path');
  path.setAttribute('d', describeArc(innerRadius, outerRadius, start, end));
  path.setAttribute('fill', p.color);
  path.setAttribute('class', 'segment');
  path.setAttribute('data-index', i);
  path.setAttribute('data-key', p.key);
  path.setAttribute('role', 'button');
  path.setAttribute('tabindex', '0');
  path.style.transition = 'transform 160ms ease, filter 160ms ease';
  segGroup.appendChild(path);

  const midAngle = start + segAngle/2;
  const lx = Math.cos(midAngle * Math.PI/180) * (outerRadius + 20);
  const ly = Math.sin(midAngle * Math.PI/180) * (outerRadius + 20);
  const text = document.createElementNS(svgNS, 'text');
  text.setAttribute('x', lx);
  text.setAttribute('y', ly + 3);
  text.setAttribute('text-anchor', Math.abs(midAngle) % 360 > 90 && Math.abs(midAngle) % 360 < 270 ? 'end' : 'start');
  text.setAttribute('font-size', '7');
  text.setAttribute('fill', '#cfeffd');
  text.setAttribute('style','font-weight:600;opacity:0.95');
  text.textContent = p.label;
  segGroup.appendChild(text);

  const dot = document.createElement('div');
  dot.className = 'dot';
  dot.innerHTML = `<span class="color-box" style="background:${p.color}"></span><span>${p.label}</span>`;
  legendEl.appendChild(dot);
});

/* Interactivity */
function updateDetails(index, lock) {
  activeIndex = index;
  segGroup.querySelectorAll('.segment').forEach(s => {
    s.classList.remove('active');
    s.style.transform = '';
  });
  const selected = segGroup.querySelector(`.segment[data-index='${index}']`);
  if (selected) {
    selected.classList.add('active');
    selected.style.transform = 'scale(1.04)';
  }
  const p = phases[index];
  phaseTitle.textContent = p.label;
  phaseText.textContent = p.text;
  centerText.textContent = p.label;
  // show tools
  toolsBox.setAttribute('aria-hidden','false');
  toolList.innerHTML = '';
  p.tools.forEach(t => {
    const li = document.createElement('li'); li.textContent = t;
    toolList.appendChild(li);
  });
  if (p.links && p.links.length) {
    const li = document.createElement('li');
    p.links.forEach((lk, idx) => {
      const a = document.createElement('a'); a.href = lk; a.target='_blank';
      a.textContent = (idx===0? 'Docs' : 'Link') + ' →';
      a.style.display = 'inline-block';
      a.style.marginRight = '8px';
      li.appendChild(a);
    });
    toolList.appendChild(li);
  }
  if (lock) stopAuto();
}

segGroup.querySelectorAll('.segment').forEach(el => {
  el.addEventListener('mouseenter', () => el.style.transform = 'scale(1.02)');
  el.addEventListener('mouseleave', () => {
    if (parseInt(el.dataset.index) !== activeIndex) el.style.transform = '';
  });
  el.addEventListener('click', (e) => {
    const idx = parseInt(el.dataset.index);
    updateDetails(idx, true);
  });
  el.addEventListener('keydown', (ev) => {
    if (ev.key === 'Enter' || ev.key === ' ') { ev.preventDefault(); updateDetails(parseInt(el.dataset.index), true); }
  });
});

// center click to reset
document.getElementById('devopsSvg').addEventListener('click', (e) => {
  const rect = e.target.closest('svg').getBoundingClientRect();
  const x = e.clientX - rect.left - rect.width/2;
  const y = e.clientY - rect.top - rect.height/2;
  const dist = Math.sqrt(x*x + y*y);
  if (dist < 30) resetSelection();
});

function resetSelection(){
  activeIndex = -1;
  segGroup.querySelectorAll('.segment').forEach(s => { s.classList.remove('active'); s.style.transform = ''; });
  phaseTitle.textContent = 'Select a phase';
  phaseText.textContent = 'Click a segment to view detailed info, recommended tools, and example actions for that phase.';
  centerText.textContent = 'DevOps';
  toolsBox.setAttribute('aria-hidden','true');
}

/* next / prev */
nextBtn.addEventListener('click', () => {
  const next = (activeIndex + 1 + phases.length) % phases.length;
  updateDetails(next, true);
});
prevBtn.addEventListener('click', () => {
  const prev = (activeIndex - 1 + phases.length) % phases.length;
  updateDetails(prev, true);
});

/* auto rotation */
autoBtn.addEventListener('click', () => {
  if (autoTimer) stopAuto(); else startAuto();
});

function startAuto(){
  autoBtn.setAttribute('aria-pressed','true'); autoBtn.textContent = 'Stop';
  let i = activeIndex >=0 ? activeIndex : 0;
  autoTimer = setInterval(() => {
    updateDetails(i % phases.length, false);
    i++;
  }, autoSpeed);
}
function stopAuto(){
  autoBtn.setAttribute('aria-pressed','false'); autoBtn.textContent = 'Auto Rotate';
  clearInterval(autoTimer); autoTimer = null;
}
speedRange.addEventListener('input', (e) => {
  autoSpeed = parseInt(e.target.value,10);
  if (autoTimer) { stopAuto(); startAuto(); }
});

/* keyboard nav */
document.addEventListener('keydown', (e) => {
  if (e.key === 'ArrowRight') nextBtn.click();
  if (e.key === 'ArrowLeft') prevBtn.click();
  if (e.key >= '1' && e.key <= String(phases.length)) {
    const idx = parseInt(e.key) - 1; updateDetails(idx, true);
  }
});

/* Export SVG as PNG */
exportBtn.addEventListener('click', async () => {
  const svg = document.getElementById('devopsSvg');
  // Serialize SVG
  const serializer = new XMLSerializer();
  const svgStr = serializer.serializeToString(svg);
  const blob = new Blob([svgStr], {type: 'image/svg+xml;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  const img = new Image();
  const canvas = document.createElement('canvas');
  const size = 900; // higher res
  canvas.width = size; canvas.height = size;
  img.onload = () => {
    const ctx = canvas.getContext('2d');
    // white background depending on theme
    const bodyIsLight = document.documentElement.classList.contains('light');
    ctx.fillStyle = bodyIsLight ? '#ffffff' : '#071024';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    // draw the image centered (svg viewbox 200x200)
    ctx.drawImage(img, 0, 0, size, size);
    canvas.toBlob(blobOut => {
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blobOut);
      a.download = `devops-lifecycle.png`;
      a.click();
      URL.revokeObjectURL(a.href);
    }, 'image/png', 0.92);
    URL.revokeObjectURL(url);
  };
  img.onerror = () => {
    alert('Export failed — your browser blocked SVG rendering. Try a different browser or allow local file access.');
    URL.revokeObjectURL(url);
  };
  img.src = url;
});

/* Theme toggle */
themeToggle.addEventListener('click', () => {
  const root = document.documentElement;
  const isLight = root.classList.toggle('light');
  themeToggle.setAttribute('aria-checked', String(isLight));
});

/* Timeline view toggle */
let timelineVisible = false;
viewToggleBtn.addEventListener('click', () => {
  timelineVisible = !timelineVisible;
  document.getElementById('leftCard').style.display = timelineVisible ? 'none' : 'block';
  timelineEl.style.display = timelineVisible ? 'block' : 'none';
  viewToggleBtn.textContent = timelineVisible ? 'Wheel View' : 'Timeline View';
  if (timelineVisible) renderTimeline();
});

/* render timeline list */
function renderTimeline(){
  timelineEl.innerHTML = '';
  phases.forEach((p,i) => {
    const div = document.createElement('div'); div.className = 'item';
    div.style.borderLeftColor = p.color;
    div.innerHTML = `<div class="label">${i+1}. ${p.label}</div><div class="muted">${p.text}</div>`;
    div.addEventListener('click', () => { updateDetails(i, true); viewToggleBtn.click(); });
    timelineEl.appendChild(div);
  });
}

/* tiny boot animation: highlight each phase quickly */
let boot=0;
const bootInt = setInterval(()=> {
  updateDetails(boot % phases.length, false);
  boot++;
  if (boot > phases.length+1) { clearInterval(bootInt); resetSelection(); }
}, 120);

</script>
</body>
</html>
